program test

integer engOpen,engGetMatrix,mxCreateFull,mxGetPr
integer ep,T,D
double precision time(10),dist(10)
integer engPutMatrix,engEvalString,engClose
integer temp,status

data time /1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0/

ep=engOpen('Matlab')
T=mxCreateFull(1,10,0)

call mxSetName(T,'T')
call mxCopyReal8ToPtr(time,mxGetPr(T),10)
call engPutMatrix(ep,T)

call engEvalString(ep,'D=.5.*(-9.8).*T.^2')
call engEvalString(rp,'close;')
D = engGetMatrix(ep,'D')
call mxCopyPtrToReal8(mxGetPr(D),dist,10)

do i=1,10
   print *,time(i),dist(i)
end do
call mxFreeMatrix(T)
call mxFreeMatrix(D)
call engClose(ep)

end program